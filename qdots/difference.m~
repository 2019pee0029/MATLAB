function d = difference(p, M)

G = gauss2d(size(M), [p(1) p(2)], p(3),1);
% d = sum(sum((G - M).^2));
pddiv = ddivergence(G, M);
d = sum(ddiv(:));