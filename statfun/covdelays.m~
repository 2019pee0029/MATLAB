function C=covdelays(A, tdelay)
% C=covdelays(A, tdelays)
% Computes covariance matrices of matrix A (rows are time series) for
% time delayes specified in TDELAY

[m,n]=size(A);
t=length(tdelay);
C=zeros(m,m,t);
for indext=1:t
    for indexrow1=1:m
        for indexrow2=1:m
            arow=A(indexrow1,:);
            arowshift=circshift(arow,[1,tdelay(indext)]);          
            C(incexrow, indexcol, indext)=cov(arow,arowshift);
        end
    end
end